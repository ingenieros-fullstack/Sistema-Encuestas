# ======================================================
# ğŸŒ FRONTEND REACT + VITE (corehr.mx)
# ======================================================

<IfModule mod_rewrite.c>
  RewriteEngine On

  # =====================================
  # ğŸš« No reescribir peticiones al backend Node
  # =====================================
  RewriteCond %{REQUEST_URI} ^/encuestas(/.*)?$
  RewriteRule ^ - [L]

  # =====================================
  # ğŸš« No redirigir archivos estÃ¡ticos (assets, imÃ¡genes, fuentes, etc.)
  # =====================================
  RewriteCond %{REQUEST_URI} \.(js|css|png|jpg|jpeg|gif|svg|webp|ico|woff|woff2|ttf|eot|json|txt|map)$ [NC]
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  # =====================================
  # âš™ï¸ React Router SPA: Redirigir rutas inexistentes a index.html
  # =====================================
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ index.html [L]
</IfModule>

# ======================================================
# ğŸš€ CACHE CONTROL â€” Rendimiento + despliegues limpios
# ======================================================

<IfModule mod_headers.c>
  # ğŸ”¹ Evitar cache en HTML
  <FilesMatch "\.(html)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
  </FilesMatch>

  # ğŸ”¹ Cache largo en assets con hash (Vite)
  <FilesMatch "\.(js|css|png|jpg|jpeg|gif|svg|webp|ico|woff2?|ttf|eot|json|map)$">
    Header set Cache-Control "max-age=31536000, public, immutable"
  </FilesMatch>

  # âœ… Seguridad bÃ¡sica
  Header set X-Content-Type-Options "nosniff"
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Frame-Options "SAMEORIGIN"
  Header always set Access-Control-Allow-Origin "https://corehr.mx"
</IfModule>

# âœ… Forzar UTF-8
AddDefaultCharset UTF-8
